<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>El Sótano del Doctor – Uso Interno</title>
  <meta property="og:title" content="El Sótano del Doctor – Uso Interno" />
  <meta property="og:description" content="Banda de rock y versiones. Explora nuestro setlist, fechas de conciertos y mucho más. ¡Disfruta de la música!" />
  <meta property="og:image" content="assets/logo_negro copia.jpg" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tusitioweb.com" />
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="El Sótano del Doctor – Uso Interno"/>
  <meta name="twitter:description" content="Banda de rock y versiones. Explora nuestro setlist, fechas de conciertos y mucho más. ¡Disfruta de la música!"/>
  <meta name="twitter:image" content="assets/logo_negro copia.jpg"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <style>
    /* Reseteo y box-sizing */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; overflow-x: hidden; }
    body { font-family: Arial, sans-serif; background-color: #000; color: #fff; }
    header { background-color: #111; padding: 10px 20px; display: flex; align-items: center; justify-content: space-between; }
    .logo img { width: 180px; height: auto; }
    .hamburger { cursor: pointer; border: 1px solid #0cf; border-radius: 4px; padding: 5px; }
    .hamburger div { width: 25px; height: 3px; background-color: #0cf; margin: 4px 0; }
    .sidebar { position: fixed; top: 0; left: 0; width: 250px; height: 100%; background-color: #111; border-right: 1px solid #222; padding: 20px; box-shadow: 2px 0 10px rgba(0, 255, 255, 0.1); transform: translateX(-250px); transition: transform 0.3s ease; z-index: 9999; }
    .sidebar.show { transform: translateX(0); }
    .sidebar h2 { color: #0cf; margin-top: 0; }
    .sidebar a { display: block; color: #fff; text-decoration: none; margin: 10px 0; padding: 5px 0; border-bottom: 1px solid #222; }
    .sidebar a:hover { color: #0cf; }
    #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9998; display: none; }
    #overlay.show { display: block; }
    #config-screen, #miembros-screen, #admin-panel-screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #000; z-index: 9999; overflow-y: auto; padding: 60px 20px 20px 20px; }
    #config-screen h2, #miembros-screen h2, #admin-panel-screen h2 { text-align: center; margin-bottom: 20px; color: #0cf; }
    #config-screen p, #miembros-screen p, #admin-panel-screen p { text-align: center; color: #aaa; margin-bottom: 20px; }
    #config-screen input, #miembros-screen input, #admin-panel-screen input { width: 100%; max-width: 400px; padding: 10px; background-color: #222; color: #fff; border: 1px solid #333; border-radius: 5px; }
    #config-screen button, #miembros-screen button, #admin-panel-screen button { margin-top: 20px; padding: 10px 20px; background-color: #0cf; color: #000; border: none; border-radius: 8px; cursor: pointer; }
    #config-screen button:hover, #miembros-screen button:hover, #admin-panel-screen button:hover { background-color: #09b; }
    #close-config, #close-miembros, #close-admin-panel { position: absolute; top: 20px; right: 20px; font-size: 1.2em; background: none; border: 1px solid #0cf; color: #0cf; border-radius: 4px; padding: 5px 10px; cursor: pointer; }
    #close-config:hover, #close-miembros:hover, #close-admin-panel:hover { background-color: #333; }
    main section { max-width: 1200px; margin: 0 auto; padding: 20px; }
    #setlists, #second-setlist, #calendario, #encuestas, #admin-panel, #login-admin { background-color: #111; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0, 255, 255, 0.1); margin-bottom: 40px; }
    #setlists h2, #second-setlist h2, #calendario h2, #encuestas h2, #admin-panel h2, #login-admin h3 { text-align: center; color: #0cf; margin-bottom: 15px; }
    #setlists p, #second-setlist p, #calendario p, #encuestas p { text-align: center; color: #aaa; margin-bottom: 20px; }
    #setlists table, #second-list-table { width: 100%; border-collapse: collapse; margin-top: 20px; color: #fff; font-size: 0.95em; }
    #setlists thead, #second-list-table thead { background-color: #222; color: #0cf; }
    #setlists th, #setlists td, #second-list-table th, #second-list-table td { padding: 12px; border: 1px solid #333; text-align: left; }
    #setlists tr:nth-child(even), #second-list-table tr:nth-child(even) { background-color: #1a1a1a; }
    #download-btn, #download-btn-2, #guardar-config, #login-btn, #agregar-fecha, #form-encuesta button { display: block; margin: 20px auto 0 auto; padding: 10px 20px; font-size: 1em; background-color: #0cf; color: #000; border: none; border-radius: 8px; cursor: pointer; }
    #download-btn:hover, #download-btn-2:hover, #guardar-config:hover, #login-btn:hover, #agregar-fecha:hover, #form-encuesta button:hover { background-color: #09b; }
    #total-time, #total-time-2 { color: #0cf; margin-top: 10px; text-align: center; }
    #concert-title { text-align: center; display: block; margin-bottom: 10px; color: #fff; font-size: 1.2em; font-weight: bold; }
    footer { background-color: #111; color: #888; text-align: center; padding: 10px; border-top: 1px solid #222; }
    @media (max-width: 768px) { .hamburger div { width: 20px; } }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <img src="assets/logo_blanco.png" alt="Logo de El Sótano del Doctor" />
    </div>
    <div class="hamburger" id="hamburger-btn">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </header>
  <div id="overlay"></div>
  <nav class="sidebar" id="sidebar-menu">
    <h2>Menú</h2>
    <a href="#" id="menu-config">Configuración</a>
    <a href="#" id="menu-miembros">Miembros</a>
    <a href="#" id="menu-admin-panel">Panel Admin</a>
    <a href="#" id="menu-cerrar">Cerrar Menú</a>
  </nav>
  <div id="config-screen">
    <button id="close-config">Cerrar</button>
    <h2>Configuración del Segundo Setlist</h2>
    <p>No toques si no sabes...</p>
    <label for="concert-title-input">Nombre del próximo concierto</label>
    <input type="text" id="concert-title-input" placeholder="Ej: Concierto Sala X, Festival Y..." />
    <label for="feed-url" style="margin-top: 20px;">ID/URL del feed</label>
    <input type="text" id="feed-url" placeholder="Ej: TXHvyb o https://www.bandhelper.com/feed/set_list/..." />
    <button id="guardar-config">Guardar configuración</button>
  </div>
  <div id="miembros-screen">
    <button id="close-miembros">Cerrar</button>
    <h2>Miembros del Grupo</h2>
    <p>Información de contacto de los miembros de la banda</p>
    <div id="miembros-lista"></div>
    <button id="agregar-miembro">Añadir miembro</button>
  </div>
  <div id="admin-panel-screen">
    <button id="close-admin-panel">Cerrar</button>
    <h2>Panel de Administración</h2>
    <input id="nueva-fecha" type="text" placeholder="Ej: Miércoles 10 abril - 17:30">
    <button id="agregar-fecha">Agregar Fecha</button>
    <ul id="fechas-activas"></ul>
  </div>
  <main>
    <section id="setlists">
      <h2>Setlist Ensayos -Año 2025-</h2>
      <p>Consulta y exporta el setlist de ensayos en tiempo real.</p>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Título</th>
            <th>Tonalidad</th>
            <th>Tempo</th>
            <th>Duración</th>
          </tr>
        </thead>
        <tbody id="setlist-body"></tbody>
      </table>
      <button id="download-btn">Descargar PDF</button>
      <p id="total-time"></p>
    </section>
    <section id="second-setlist">
      <h2>Setlist Próximo Concierto</h2>
      <h3 id="concert-title"></h3>
      <p>Feed actual: <em id="url-actual"></em></p>
      <table id="second-list-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Canción</th>
            <th>Tonalidad</th>
            <th>Tempo</th>
            <th>Duración</th>
          </tr>
        </thead>
        <tbody id="second-body"></tbody>
      </table>
      <button id="download-btn-2">Descargar PDF</button>
      <p id="total-time-2"></p>
    </section>
    <section id="calendario">
      <h2>Próximos Conciertos</h2>
      <p>Consulta el calendario actualizado.</p>
      <div>
        <script type="text/javascript" src="https://www.bandhelper.com/widget/calendar/10353?range=6"></script>
      </div>
    </section>
    <section id="encuestas">
      <h2>Encuesta de Fechas para el Próximo Ensayo</h2>
      <p>Marca las fechas en las que estás disponible:</p>
      <form id="form-encuesta">
        <div id="opciones-fechas"></div>
        <button type="submit">Enviar Voto</button>
      </form>
      <div id="resultados-encuesta" style="display:none;">
        <h3>Resultados hasta ahora</h3>
        <ul id="lista-resultados"></ul>
      </div>
    </section>
    <section id="login-admin">
      <h3>Acceso a Panel de Administración</h3>
      <input type="password" id="admin-pass" placeholder="Contraseña">
      <button id="login-btn">Entrar</button>
    </section>
  </main>
  <footer>
    © 2025 El Sótano del Doctor. All Rights Reserved.
  </footer>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  <script>
    /************************************************************/
    /* 1. MÓDULO DE ENCUESTAS PARA ENSAYOS (Firebase)          */
    /************************************************************/
    const firebaseConfig = {
      apiKey: "AIzaSyAd70p3aEA218oPLWEs_DbMFEotHXfVyNg",
      authDomain: "el-sotano-del-doctor.firebaseapp.com",
      projectId: "el-sotano-del-doctor",
      storageBucket: "el-sotano-del-doctor.appspot.com",
      messagingSenderId: "288654488846",
      appId: "1:288654488846:web:51a726467eaf8e8a88535f",
      measurementId: "G-5N86SGCGW1"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    let usuarioActual = prompt("Por favor, introduce tu nombre:");
    async function cargarFechasDisponibles() {
      const container = document.getElementById('opciones-fechas');
      container.innerHTML = '';
      const snapshot = await db.collection('fechasDisponibles').get();
      snapshot.forEach(doc => {
        const label = document.createElement('label');
        label.innerHTML = `<input type="checkbox" name="fecha" value="${doc.id}"> ${doc.id}<br>`;
        container.appendChild(label);
      });
    }
    async function enviarVotos(fechas) {
      const votosRef = db.collection('votacionesEnsayos');
      const votosUsuario = await votosRef.where('usuario', '==', usuarioActual).get();
      if (!votosUsuario.empty) {
        alert('Ya has votado. No puedes votar de nuevo.');
        return;
      }
      for (const fecha of fechas) {
        const doc = await votosRef.doc(fecha + usuarioActual).get();
        if (doc.exists) {
          await votosRef.doc(fecha + usuarioActual).update({ votos: firebase.firestore.FieldValue.increment(1) });
        } else {
          await votosRef.doc(fecha + usuarioActual).set({ votos: 1, usuario: usuarioActual });
        }
      }
      mostrarResultados();
    }
    async function mostrarResultados() {
      const lista = document.getElementById('lista-resultados');
      lista.innerHTML = '';
      const snapshot = await db.collection('votacionesEnsayos').get();
      const votosPorFecha = {};
      snapshot.forEach(doc => {
        const fecha = doc.id.replace(usuarioActual, '');
        if (votosPorFecha[fecha]) {
          votosPorFecha[fecha] += 1;
        } else {
          votosPorFecha[fecha] = 1;
        }
      });
      for (const fecha in votosPorFecha) {
        const li = document.createElement('li');
        li.textContent = `${fecha}: ${votosPorFecha[fecha]} voto(s)`;
        lista.appendChild(li);
      }
      document.getElementById('resultados-encuesta').style.display = 'block';
    }
    document.getElementById('form-encuesta').addEventListener('submit', async function(e) {
      e.preventDefault();
      const fechasSeleccionadas = Array.from(document.querySelectorAll('input[name="fecha"]:checked')).map(input => input.value);
      if (fechasSeleccionadas.length === 0) {
        alert('Por favor, selecciona al menos una fecha.');
        return;
      }
      await enviarVotos(fechasSeleccionadas);
    });
    /************************************************************/
    /* 2. PANEL DE ADMINISTRACIÓN (Firebase)                   */
    /************************************************************/
    const CLAVE_ADMIN = "ensayo2025";
    document.getElementById('login-btn').addEventListener('click', () => {
      const clave = document.getElementById('admin-pass').value.trim();
      if (clave === CLAVE_ADMIN) {
        document.getElementById('admin-panel-screen').style.display = 'block';
        document.getElementById('login-admin').style.display = 'none';
        cargarFechasAdmin();
      } else {
        alert('Clave incorrecta.');
      }
    });
    document.getElementById('agregar-fecha').addEventListener('click', async () => {
      const nueva = document.getElementById('nueva-fecha').value.trim();
      if (!nueva) return;
      await db.collection('fechasDisponibles').doc(nueva).set({ activa: true });
      document.getElementById('nueva-fecha').value = '';
      cargarFechasDisponibles();
      cargarFechasAdmin();
    });
    async function cargarFechasAdmin() {
      const ul = document.getElementById('fechas-activas');
      ul.innerHTML = '';
      const snapshot = await db.collection('fechasDisponibles').get();
      snapshot.forEach(doc => {
        const li = document.createElement('li');
        li.textContent = doc.id;
        const btn = document.createElement('button');
        btn.textContent = 'Eliminar';
        btn.style.marginLeft = '10px';
        btn.style.background = 'red';
        btn.style.color = '#fff';
        btn.style.border = 'none';
        btn.style.borderRadius = '4px';
        btn.style.cursor = 'pointer';
        btn.onclick = async () => {
          await db.collection('fechasDisponibles').doc(doc.id).delete();
          cargarFechasDisponibles();
          cargarFechasAdmin();
        };
        li.appendChild(btn);
        ul.appendChild(li);
      });
    }
    cargarFechasDisponibles();
    mostrarResultados();
    /************************************************************/
    /* 3. FUNCIONES AUXILIARES (Formato de Horas, Limpieza)    */
    /************************************************************/
    function parseDurationToSeconds(str) {
      if (!str) return 0;
      if (str.includes(':')) {
        const [min, sec] = str.split(':').map(n => parseInt(n, 10));
        return (min * 60) + (sec || 0);
      }
      const secs = parseInt(str, 10);
      return isNaN(secs) ? 0 : secs;
    }
    function formatSecondsHMSorMMSS(totalSeconds) {
      if (totalSeconds < 3600) {
        const m = Math.floor(totalSeconds / 60);
        const s = totalSeconds % 60;
        return `<span class="math-inline">\{m\}\:</span>{String(s).padStart(2, '0')}`;
      } else {
        const h = Math.floor(totalSeconds / 3600);
        const rest = totalSeconds % 3600;
        const m = Math.floor(rest / 60);
        const s = rest % 60;
        return `<span class="math-inline">\{h\}\:</span>{String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
      }
    }
    function cleanString(str) {
      if (!str) return '';
      let cleaned = str.replace(/[^\x00-\xFF]/g, '');
      return cleaned.trim();
    }
    /************************************************************/
    /* 4. PRIMER SETLIST (Carga y Descarga PDF)                */
    /************************************************************/
    const urlPrimerSetlist = 'https://cold-limit-811a.jagomezc.workers.dev';
    async function cargarPrimerSetlist() {
      try {
        const res = await fetch(urlPrimerSetlist);
        const data = await res.json();
        const tbody = document.getElementById('setlist-body');
        tbody.innerHTML = '';
        const songs = data.filter(item => item.type === 'song');
        let totalSecs = 0;
        songs.forEach((song, i) => {
          const secs = parseDurationToSeconds(song.duration || '');
          totalSecs += secs;
          const row = document.createElement('tr');
          row.innerHTML = `
            <td><span class="math-inline">\{i \+ 1\}</td\>
<td\></span>{cleanString(song.name || '')}</td>
            <td><span class="math-inline">\{cleanString\(song\.key \|\| ''\)\}</td\>
<td\></span>{cleanString(song.tempo || '')}</td>
            <td>${formatSecondsHMSorMMSS(secs)}</td>
          `;
          tbody.appendChild(row);
        });
        document.getElementById('total-time').textContent = 'Tiempo total del set: ' + formatSecondsHMSorMMSS(totalSecs);
        return songs;
      } catch (err) {
        console.error('Error al cargar el primer setlist:', err);
        document.getElementById('setlist-body').innerHTML = '<tr><td colspan="5">Error al cargar el primer setlist.</td></tr>';
        return [];
      }
    }
    async function descargarPDFprimerSetlist() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'portrait', unit: 'pt', format: 'A4' });
      doc.setFont('helvetica', 'normal');
      const songs = await cargarPrimerSetlist();
      try {
        const imgUrl = 'assets/logo_negro copia.jpg';
        const imgRes = await fetch(imgUrl);
        const imgBlob = await imgRes.blob();
        const reader = new FileReader();
        const base64Promise = new Promise((resolve, reject) => {
          reader.onload = () => resolve(reader.result);
          reader.onerror = reject;
        });
        reader.readAsDataURL(imgBlob);
        const base64Img = await base64Promise;
        doc.addImage(base64Img, 'JPEG', 40, 30, 60, 60);
      } catch (err) {
        console.warn('No se pudo cargar el logo (primer setlist):', err);
      }
      doc.setFontSize(16);
      doc.setTextColor(40);
      doc.text('Setlist - El Sótano del Doctor (Primer)', 120, 50);
      let totalSecs = 0;
      songs.forEach(s => {
        const secs = parseDurationToSeconds(s.duration || '0');
        totalSecs += secs;
      });
      const totalTime = formatSecondsHMSorMMSS(totalSecs);
      const totalSongs = songs.length;
      doc.setFontSize(12);
      doc.setTextColor(80);
      doc.text(`${totalSongs} canciones, ${totalTime} total`, 120, 70);
      const columns = [
        { header: '#', dataKey: 'num' },
        { header: 'Título', dataKey: 'title' },
        { header: 'Tonalidad', dataKey: 'key' },
        { header: 'Tempo', dataKey: 'tempo' },
        { header: 'Duración', dataKey: 'duration' }
      ];
      const rows = songs.map((song, i) => {
        const secs = parseDurationToSeconds(song.duration || '0');
        return {
          num: i + 1,
          title: cleanString(song.name || ''),
          key: cleanString(song.key || ''),
          tempo: cleanString(song.tempo || ''),
          duration: formatSecondsHMSorMMSS(secs)
        };
      });
      doc.autoTable({
        startY: 100,
        head: [columns.map(c => c.header)],
        body: rows.map(r => [r.num, r.title, r.key, r.tempo, r.duration]),
        headStyles: { fillColor: [60, 60, 60], textColor: [255, 255, 255], fontStyle: 'bold' },
        bodyStyles: { fillColor: [245, 245, 245], textColor: [0, 0, 0] },
        alternateRowStyles: { fillColor: [230, 230, 230] },
        styles: { halign: 'left', fontSize: 10, cellPadding: 5 },
        columnStyles: { 0: { cellWidth: 30 }, 1: { cellWidth: 150 }, 2: { cellWidth: 80 }, 3: { cellWidth: 50 }, 4: { cellWidth: 60 } }
      });
      doc.save('setlist_ElSotanoDelDoctor.pdf');
    }
    /************************************************************/
    /* 5. SEGUNDO SETLIST (Carga y Descarga PDF, Configuración)*/
    /************************************************************/
    let urlSegundoSetlist = 'https://www.bandhelper.com/feed/set_list/TXHvyb';
    let secondSetlistConcertTitle = '';
    function loadConfigFromLocalStorage() {
      const savedURL = localStorage.getItem('urlSegundoSetlist');
      if (savedURL) urlSegundoSetlist = savedURL;
      const savedTitle = localStorage.getItem('secondSetlistConcertTitle');
      if (savedTitle) secondSetlistConcertTitle = savedTitle;
    }
    function saveConfigToLocalStorage(url, title) {
      localStorage.setItem('urlSegundoSetlist', url);
      localStorage.setItem('secondSetlistConcertTitle', title);
    }
    function displayConcertTitle() {
      document.getElementById('concert-title').textContent = secondSetlistConcertTitle;
    }
    function getSecondSetlistURL() {
      return urlSegundoSetlist;
    }
    async function cargarSegundoSetlist() {
      try {
        displayConcertTitle();
        const url = getSecondSetlistURL();
        const res = await fetch(url);
        const data = await res.json();
        const songs = data.filter(item => item.type === 'song');
        const tbody = document.getElementById('second-body');
        tbody.innerHTML = '';
        let totalSecs = 0;
        songs.forEach((song, index) => {
          const secs = parseDurationToSeconds(song.duration || '0');
          totalSecs += secs;
          const row = document.createElement('tr');
          row.innerHTML = `
            <td><span class="math-inline">\{index \+ 1\}</td\>
<td\></span>{cleanString(song.name || '')}</td>
            <td><span class="math-inline">\{cleanString\(song\.key \|\| ''\)\}</td\>
<td\></span>{cleanString(song.tempo || '')}</td>
            <td>${formatSecondsHMSorMMSS(secs)}</td>
          `;
          tbody.appendChild(row);
        });
        document.getElementById('url-actual').textContent = url;
        document.getElementById('total-time-2').textContent = 'Tiempo total del set: ' + formatSecondsHMSorMMSS(totalSecs);
        return songs;
      } catch (err) {
        console.error('Error al cargar el segundo setlist:', err);
        document.getElementById('second-body').innerHTML = '<tr><td colspan="5">Error al cargar el segundo setlist.</td></tr>';
        return [];
      }
    }
    async function descargarPDFsegundoSetlist() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'portrait', unit: 'pt', format: 'A4' });
      doc.setFont('helvetica', 'normal');
      const songs = await cargarSegundoSetlist();
      try {
        const imgUrl = 'assets/logo_negro copia.jpg';
        const imgRes = await fetch(imgUrl);
        const imgBlob = await imgRes.blob();
        const reader = new FileReader();
        const base64Promise = new Promise((resolve, reject) => {
          reader.onload = () => resolve(reader.result);
          reader.onerror = reject;
        });
        reader.readAsDataURL(imgBlob);
        const base64Img = await base64Promise;
        doc.addImage(base64Img, 'JPEG', 40, 30, 60, 60);
      } catch (err) {
        console.warn('No se pudo cargar el logo (segundo setlist):', err);
      }
      doc.setFontSize(16);
      doc.setTextColor(40);
      const pdfTitle = secondSetlistConcertTitle || 'El Sótano del Doctor (Segundo)';
      doc.text(`Setlist - ${pdfTitle}`, 120, 50);
      let totalSecs = 0;
      songs.forEach(song => {
        totalSecs += parseDurationToSeconds(song.duration || '0');
      });
      const totalTime = formatSecondsHMSorMMSS(totalSecs);
      const totalSongs = songs.length;
      doc.setFontSize(12);
      doc.setTextColor(80);
      doc.text(`${totalSongs} canciones, ${totalTime} total`, 120, 70);
      const columns2 = [
        { header: '#', dataKey: 'num' },
        { header: 'Canción', dataKey: 'name' },
        { header: 'Tonalidad', dataKey: 'key' },
        { header: 'Tempo', dataKey: 'tempo' },
        { header: 'Duración', dataKey: 'duration' }
      ];
      const rows2 = songs.map((song, i) => {
        const secs = parseDurationToSeconds(song.duration || '0');
        return {
          num: i + 1,
          name: cleanString(song.name || ''),
          key: cleanString(song.key || ''),
          tempo: cleanString(song.tempo || ''),
          duration: formatSecondsHMSorMMSS(secs)
        };
      });
      doc.autoTable({
        startY: 100,
        head: [columns2.map(c => c.header)],
        body: rows2.map(r => [r.num, r.name, r.key, r.tempo, r.duration]),
        headStyles: { fillColor: [60, 60, 60], textColor: [255, 255, 255], fontStyle: 'bold' },
        bodyStyles: { fillColor: [245, 245, 245], textColor: [0, 0, 0] },
        alternateRowStyles: { fillColor: [230, 230, 230] },
        styles: { halign: 'left', fontSize: 10, cellPadding: 5 },
        columnStyles: { 0: { cellWidth: 30 }, 1: { cellWidth: 150 }, 2: { cellWidth: 80 }, 3: { cellWidth: 50 }, 4: { cellWidth: 60 } }
      });
      doc.save('SegundoSetlist.pdf');
    }
    /************************************************************/
    /* 6. MENÚ HAMBURGUESA Y CONFIGURACIÓN GENERAL            */
    /************************************************************/
    const hamburgerBtn = document.getElementById('hamburger-btn');
    const sidebarMenu = document.getElementById('sidebar-menu');
    const menuConfig = document.getElementById('menu-config');
    const menuMiembros = document.getElementById('menu-miembros');
    const menuAdminPanel = document.getElementById('menu-admin-panel');
    const menuCerrar = document.getElementById('menu-cerrar');
    const overlay = document.getElementById('overlay');
