<main>
    <section id="setlists" style="padding: 30px; margin-bottom: 50px;">
        <h2 style="text-align: center; color: #00ffff; font-size: 2em;">ðŸŽ¼ Setlists Ensayos 2025 ðŸŽ¶</h2>
        <div style="overflow-x: auto; margin-top: 20px;">
            <table id="setlist-table" style="width: 100%; border-collapse: collapse; font-family: Arial, sans-serif;">
                <thead>
                    <tr style="background-color: #111; color: #0ff;">
                        <th style="padding: 10px; border: 1px solid #333;">TÃ­tulo</th>
                        <th style="padding: 10px; border: 1px solid #333;">Tonalidad</th>
                        <th style="padding: 10px; border: 1px solid #333;">Tempo</th>
                        <th style="padding: 10px; border: 1px solid #333;">DuraciÃ³n</th>
                    </tr>
                </thead>
                <tbody id="setlist-body" style="background-color: #222; color: #fff;"></tbody>
            </table>
        </div>
        <p style="text-align: center; font-size: 0.9em; color: #888; margin-top: 10px;">
            ðŸ“² Setlist actualizado en tiempo real desde BandHelper
        </p>
    </section>

    <section>
        <h2>Calendario de actuaciones</h2>
        <p>AquÃ­ podrÃ¡s consultar todas las fechas confirmadas.</p>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const url = 'https://cold-limit-811a.jagomezc.workers.dev';

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    const tbody = document.getElementById('setlist-body');
                    if (!Array.isArray(data) || data.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;">No hay canciones en el setlist.</td></tr>';
                        return;
                    }

                    const songs = data.filter(item => item.type === 'song');

                    if (songs.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;">No hay canciones en el setlist.</td></tr>';
                        return;
                    }

                    songs.forEach(song => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td style="padding: 10px; border: 1px solid #444;">${song.name || ''}</td>
                            <td style="padding: 10px; border: 1px solid #444;">${song.key || ''}</td>
                            <td style="padding: 10px; border: 1px solid #444;">${song.tempo || ''}</td>
                            <td style="padding: 10px; border: 1px solid #444;">${song.duration || ''}</td>
                        `;
                        tbody.appendChild(row);
                    });
                })
                .catch(err => {
                    console.error('Error al cargar el setlist:', err);
                    const tbody = document.getElementById('setlist-body');
                    tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;">Error al cargar el setlist.</td></tr>';
                });
        });
    </script>
</main>
